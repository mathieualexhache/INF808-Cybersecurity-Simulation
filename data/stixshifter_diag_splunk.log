


## Diagnose: config verification

#### Kestrel specific config
retrieval batch size: 10000
cool down after transmission: 1
allow unverified connector: True
verify SSL or not: False
split query into subquery: False
subquery with time window (in seconds): 0
enable fast translation: False

#### Config to be passed to stix-shifter
connector name: splunk
connection object [ref: https://github.com/opencybersecurityalliance/stix-shifter/blob/develop/OVERVIEW.md#connection]:
{
    "host": "SplunkServerDefaultCert",
    "port": 8089,
    "options": {
        "index": "main",
        "result_limit": 20000,
        "timeout": 60
    }
}
configuration object [ref: https://github.com/opencybersecurityalliance/stix-shifter/blob/develop/OVERVIEW.md#configuration]:
{
    "auth": {
        "username": "********",
        "password": "********"
    }
}



## Diagnose: stix-shifter query translation

#### Input: STIX pattern
[ipv4-addr:value != '255.255.255.255'] START t'2024-12-17T03:10:08.899Z' STOP t'2024-12-17T03:15:08.899Z'

#### Output: 1 data source native queries
search index="main" ((src_ip != "255.255.255.255") OR (dest_ip != "255.255.255.255")) earliest="12/17/2024:03:10:08" latest="12/17/2024:03:15:08" | head 20000 | fields src_ip, src_port, src_mac, dest_ip, dest_port, dest_mac, file_hash, user, url, protocol, host, source, severity, process, process_id, process_name, process_exec, process_path, process_hash, process_guid, parent_process, parent_process_id, parent_process_name, parent_process_exec, description, signature, signature_id, query, answer, transport, bytes_in, bytes_out, packets_in, packets_out, direction, name, message_type, query_count, query_type, record_type, reply_code, reply_code_id, vendor_product, duration, transaction_id, action, file_access_time, file_acl, registry_hive, registry_path, registry_key_name, registry_value_data, registry_value_name, registry_value_text, registry_value_type, status, ssl_version, ssl_serial, ssl_issuer, ssl_subject, ssl_signature_algorithm, ssl_publickey_algorithm, ssl_start_time, ssl_end_time, ssl_is_valid, ssl_issuer_common_name, ssl_subject_common_name, ssl_name, ssl_publickey, ssl_issuer_email, ssl_subject_email, ssl_issuer_email_domain, ssl_subject_email_domain, ssl_issuer_organization, ssl_subject_organization, recipient, subject, file_hash, file_name, file_size, recipient_domain, src_user_domain, internal_message_id, message_id, message_info, app, authentication_method, authentication_service, dest, src, src_user, user_name, user_id, user_type, user_agent, http_method, http_referrer, http_user_agent, uri_path, uri_query, os, dvc, id, msft, cve, cvss, mskb, type, eventtype, event_id, mitre_technique_id, mem_used, original_file_name, file_create_time, file_modify_time



## Diagnose: stix-shifter to data source connection (network, auth)

#### Results from stixshifter transmission.ping()
{
    "success": true
}



## Diagnose: stix-shifter query execution: <=1 batch(s)

#### data retrieval results:
no result matched for query: search index="main" ((src_ip != "255.255.255.255") OR (dest_ip != "255.255.255.255")) earliest="12/17/2024:03:10:08" latest="12/17/2024:03:15:08" | head 20000 | fields src_ip, src_port, src_mac, dest_ip, dest_port, dest_mac, file_hash, user, url, protocol, host, source, severity, process, process_id, process_name, process_exec, process_path, process_hash, process_guid, parent_process, parent_process_id, parent_process_name, parent_process_exec, description, signature, signature_id, query, answer, transport, bytes_in, bytes_out, packets_in, packets_out, direction, name, message_type, query_count, query_type, record_type, reply_code, reply_code_id, vendor_product, duration, transaction_id, action, file_access_time, file_acl, registry_hive, registry_path, registry_key_name, registry_value_data, registry_value_name, registry_value_text, registry_value_type, status, ssl_version, ssl_serial, ssl_issuer, ssl_subject, ssl_signature_algorithm, ssl_publickey_algorithm, ssl_start_time, ssl_end_time, ssl_is_valid, ssl_issuer_common_name, ssl_subject_common_name, ssl_name, ssl_publickey, ssl_issuer_email, ssl_subject_email, ssl_issuer_email_domain, ssl_subject_email_domain, ssl_issuer_organization, ssl_subject_organization, recipient, subject, file_hash, file_name, file_size, recipient_domain, src_user_domain, internal_message_id, message_id, message_info, app, authentication_method, authentication_service, dest, src, src_user, user_name, user_id, user_type, user_agent, http_method, http_referrer, http_user_agent, uri_path, uri_query, os, dvc, id, msft, cve, cvss, mskb, type, eventtype, event_id, mitre_technique_id, mem_used, original_file_name, file_create_time, file_modify_time, go next query
no result matched for pattern: [ipv4-addr:value != '255.255.255.255'] START t'2024-12-17T03:10:08.899Z' STOP t'2024-12-17T03:15:08.899Z', go next pattern

#### data retrieval results:
no result matched for query: search index="main" ((process_id > 0) OR (parent_process_id > 0)) earliest="12/17/2024:03:10:08" latest="12/17/2024:03:15:08" | head 20000 | fields src_ip, src_port, src_mac, dest_ip, dest_port, dest_mac, file_hash, user, url, protocol, host, source, severity, process, process_id, process_name, process_exec, process_path, process_hash, process_guid, parent_process, parent_process_id, parent_process_name, parent_process_exec, description, signature, signature_id, query, answer, transport, bytes_in, bytes_out, packets_in, packets_out, direction, name, message_type, query_count, query_type, record_type, reply_code, reply_code_id, vendor_product, duration, transaction_id, action, file_access_time, file_acl, registry_hive, registry_path, registry_key_name, registry_value_data, registry_value_name, registry_value_text, registry_value_type, status, ssl_version, ssl_serial, ssl_issuer, ssl_subject, ssl_signature_algorithm, ssl_publickey_algorithm, ssl_start_time, ssl_end_time, ssl_is_valid, ssl_issuer_common_name, ssl_subject_common_name, ssl_name, ssl_publickey, ssl_issuer_email, ssl_subject_email, ssl_issuer_email_domain, ssl_subject_email_domain, ssl_issuer_organization, ssl_subject_organization, recipient, subject, file_hash, file_name, file_size, recipient_domain, src_user_domain, internal_message_id, message_id, message_info, app, authentication_method, authentication_service, dest, src, src_user, user_name, user_id, user_type, user_agent, http_method, http_referrer, http_user_agent, uri_path, uri_query, os, dvc, id, msft, cve, cvss, mskb, type, eventtype, event_id, mitre_technique_id, mem_used, original_file_name, file_create_time, file_modify_time, go next query
no result matched for pattern: [process:pid > 0] START t'2024-12-17T03:10:08.899Z' STOP t'2024-12-17T03:15:08.899Z', go next pattern

#### data retrieval results:
no result matched for query: search index="main" ((src_user != "null@xyz.com") OR (recipient != "null@xyz.com") OR (ssl_issuer_email != "null@xyz.com") OR (ssl_subject_email != "null@xyz.com")) earliest="12/17/2024:03:10:08" latest="12/17/2024:03:15:08" | head 20000 | fields src_ip, src_port, src_mac, dest_ip, dest_port, dest_mac, file_hash, user, url, protocol, host, source, severity, process, process_id, process_name, process_exec, process_path, process_hash, process_guid, parent_process, parent_process_id, parent_process_name, parent_process_exec, description, signature, signature_id, query, answer, transport, bytes_in, bytes_out, packets_in, packets_out, direction, name, message_type, query_count, query_type, record_type, reply_code, reply_code_id, vendor_product, duration, transaction_id, action, file_access_time, file_acl, registry_hive, registry_path, registry_key_name, registry_value_data, registry_value_name, registry_value_text, registry_value_type, status, ssl_version, ssl_serial, ssl_issuer, ssl_subject, ssl_signature_algorithm, ssl_publickey_algorithm, ssl_start_time, ssl_end_time, ssl_is_valid, ssl_issuer_common_name, ssl_subject_common_name, ssl_name, ssl_publickey, ssl_issuer_email, ssl_subject_email, ssl_issuer_email_domain, ssl_subject_email_domain, ssl_issuer_organization, ssl_subject_organization, recipient, subject, file_hash, file_name, file_size, recipient_domain, src_user_domain, internal_message_id, message_id, message_info, app, authentication_method, authentication_service, dest, src, src_user, user_name, user_id, user_type, user_agent, http_method, http_referrer, http_user_agent, uri_path, uri_query, os, dvc, id, msft, cve, cvss, mskb, type, eventtype, event_id, mitre_technique_id, mem_used, original_file_name, file_create_time, file_modify_time, go next query
no result matched for pattern: [email-addr:value != 'null@xyz.com'] START t'2024-12-17T03:10:08.899Z' STOP t'2024-12-17T03:15:08.899Z', go next pattern



## Diagnose: stix-shifter query execution: <=5 batch(s)

#### data retrieval results:
no result matched for query: search index="main" ((src_ip != "255.255.255.255") OR (dest_ip != "255.255.255.255")) earliest="12/17/2024:03:10:08" latest="12/17/2024:03:15:08" | head 20000 | fields src_ip, src_port, src_mac, dest_ip, dest_port, dest_mac, file_hash, user, url, protocol, host, source, severity, process, process_id, process_name, process_exec, process_path, process_hash, process_guid, parent_process, parent_process_id, parent_process_name, parent_process_exec, description, signature, signature_id, query, answer, transport, bytes_in, bytes_out, packets_in, packets_out, direction, name, message_type, query_count, query_type, record_type, reply_code, reply_code_id, vendor_product, duration, transaction_id, action, file_access_time, file_acl, registry_hive, registry_path, registry_key_name, registry_value_data, registry_value_name, registry_value_text, registry_value_type, status, ssl_version, ssl_serial, ssl_issuer, ssl_subject, ssl_signature_algorithm, ssl_publickey_algorithm, ssl_start_time, ssl_end_time, ssl_is_valid, ssl_issuer_common_name, ssl_subject_common_name, ssl_name, ssl_publickey, ssl_issuer_email, ssl_subject_email, ssl_issuer_email_domain, ssl_subject_email_domain, ssl_issuer_organization, ssl_subject_organization, recipient, subject, file_hash, file_name, file_size, recipient_domain, src_user_domain, internal_message_id, message_id, message_info, app, authentication_method, authentication_service, dest, src, src_user, user_name, user_id, user_type, user_agent, http_method, http_referrer, http_user_agent, uri_path, uri_query, os, dvc, id, msft, cve, cvss, mskb, type, eventtype, event_id, mitre_technique_id, mem_used, original_file_name, file_create_time, file_modify_time, go next query
no result matched for pattern: [ipv4-addr:value != '255.255.255.255'] START t'2024-12-17T03:10:08.899Z' STOP t'2024-12-17T03:15:08.899Z', go next pattern

#### data retrieval results:
no result matched for query: search index="main" ((process_id > 0) OR (parent_process_id > 0)) earliest="12/17/2024:03:10:08" latest="12/17/2024:03:15:08" | head 20000 | fields src_ip, src_port, src_mac, dest_ip, dest_port, dest_mac, file_hash, user, url, protocol, host, source, severity, process, process_id, process_name, process_exec, process_path, process_hash, process_guid, parent_process, parent_process_id, parent_process_name, parent_process_exec, description, signature, signature_id, query, answer, transport, bytes_in, bytes_out, packets_in, packets_out, direction, name, message_type, query_count, query_type, record_type, reply_code, reply_code_id, vendor_product, duration, transaction_id, action, file_access_time, file_acl, registry_hive, registry_path, registry_key_name, registry_value_data, registry_value_name, registry_value_text, registry_value_type, status, ssl_version, ssl_serial, ssl_issuer, ssl_subject, ssl_signature_algorithm, ssl_publickey_algorithm, ssl_start_time, ssl_end_time, ssl_is_valid, ssl_issuer_common_name, ssl_subject_common_name, ssl_name, ssl_publickey, ssl_issuer_email, ssl_subject_email, ssl_issuer_email_domain, ssl_subject_email_domain, ssl_issuer_organization, ssl_subject_organization, recipient, subject, file_hash, file_name, file_size, recipient_domain, src_user_domain, internal_message_id, message_id, message_info, app, authentication_method, authentication_service, dest, src, src_user, user_name, user_id, user_type, user_agent, http_method, http_referrer, http_user_agent, uri_path, uri_query, os, dvc, id, msft, cve, cvss, mskb, type, eventtype, event_id, mitre_technique_id, mem_used, original_file_name, file_create_time, file_modify_time, go next query
no result matched for pattern: [process:pid > 0] START t'2024-12-17T03:10:08.899Z' STOP t'2024-12-17T03:15:08.899Z', go next pattern

#### data retrieval results:
no result matched for query: search index="main" ((src_user != "null@xyz.com") OR (recipient != "null@xyz.com") OR (ssl_issuer_email != "null@xyz.com") OR (ssl_subject_email != "null@xyz.com")) earliest="12/17/2024:03:10:08" latest="12/17/2024:03:15:08" | head 20000 | fields src_ip, src_port, src_mac, dest_ip, dest_port, dest_mac, file_hash, user, url, protocol, host, source, severity, process, process_id, process_name, process_exec, process_path, process_hash, process_guid, parent_process, parent_process_id, parent_process_name, parent_process_exec, description, signature, signature_id, query, answer, transport, bytes_in, bytes_out, packets_in, packets_out, direction, name, message_type, query_count, query_type, record_type, reply_code, reply_code_id, vendor_product, duration, transaction_id, action, file_access_time, file_acl, registry_hive, registry_path, registry_key_name, registry_value_data, registry_value_name, registry_value_text, registry_value_type, status, ssl_version, ssl_serial, ssl_issuer, ssl_subject, ssl_signature_algorithm, ssl_publickey_algorithm, ssl_start_time, ssl_end_time, ssl_is_valid, ssl_issuer_common_name, ssl_subject_common_name, ssl_name, ssl_publickey, ssl_issuer_email, ssl_subject_email, ssl_issuer_email_domain, ssl_subject_email_domain, ssl_issuer_organization, ssl_subject_organization, recipient, subject, file_hash, file_name, file_size, recipient_domain, src_user_domain, internal_message_id, message_id, message_info, app, authentication_method, authentication_service, dest, src, src_user, user_name, user_id, user_type, user_agent, http_method, http_referrer, http_user_agent, uri_path, uri_query, os, dvc, id, msft, cve, cvss, mskb, type, eventtype, event_id, mitre_technique_id, mem_used, original_file_name, file_create_time, file_modify_time, go next query
no result matched for pattern: [email-addr:value != 'null@xyz.com'] START t'2024-12-17T03:10:08.899Z' STOP t'2024-12-17T03:15:08.899Z', go next pattern
